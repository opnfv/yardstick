#cloud-config

disable_root: 0
ssh_pwauth:   1
chpasswd:
{% if chpasswd is defined %}
  list: |
{% for username, password in chpasswd.items() %}
    {{ username }}:{{ password }}
{% endfor %}
  expire: false
{% endif %}

write_files:
{% if "http_proxy" in proxy_env or "https_proxy" in proxy_env %}
  - path: /etc/environment
    content: |
{% for proxy, url in proxy_env.iteritems() %}
      {{ proxy }}={{ url }}
{% endfor %}

  - path: /etc/profile.d/proxy.sh
    content: |
{% for proxy, url in proxy_env.iteritems() %}
      export {{ proxy }}={{ url }}
{% endfor %}

{% endif %}

